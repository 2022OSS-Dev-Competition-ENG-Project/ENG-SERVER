<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.userservice.mapper.UserMapper">

    <insert id="SignupUser" parameterType="com.example.userservice.dto.UserDto">
        INSERT INTO user (email,
                          password,
                          name,
                          nickname,
                          phonenum,
                          birth
        )
        values (
                   #{email},
                   #{password},
                   #{name},
                   #{nickname},
                   #{phonenum}
               )
    </insert>

    <update id="conform">
        update user
        set login_key = 1
        where email = #{email}
    </update>

    <insert id="facilityJoinMy" parameterType="com.example.userservice.dto.FacilityJoinMyDto">
        insert into user_use_facility(
                                      user_uuid,
                                      user_facility
                                      )values(
                                              #(userId),
                                              #(facilityNo)
                                                     )
    </insert>
    
    <select id="findFacility" resultMap="userFacility">
        select user_facility
        from user_use_facility
        where user_facility = #{facilityNo} AND user_uuid = #{userId}
    </select>
    
</mapper>